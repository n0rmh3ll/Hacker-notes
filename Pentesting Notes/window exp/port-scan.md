
Port Scan : 

Scan internal ports inside a machine :

```
function Test-Port {
    param(
        [string]$ComputerName = "localhost",
        [int[]]$Ports = @(21,22,23,25,53,80,110,135,139,143,443,445,993,995,1433,3389,5985,5986,8080,8443)
    )
    
    foreach ($port in $Ports) {
        $tcp = New-Object System.Net.Sockets.TcpClient
        try {
            $tcp.Connect($ComputerName, $port)
            Write-Host "[+] Port $port is OPEN on $ComputerName" -ForegroundColor Green
        } catch {
            Write-Host "[-] Port $port is CLOSED on $ComputerName" -ForegroundColor Red
        } finally {
            $tcp.Close()
        }
    }
}

# Run the port scan
Test-Port -ComputerName "localhost"
```

